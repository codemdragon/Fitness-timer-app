<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aether | Sequence Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap');

        :root {
            --neon-cyan: #00f3ff;
            --dark-bg: #0a0b1e;
            --glass: rgba(255, 255, 255, 0.05);
        }

        body {
            background-color: var(--dark-bg);
            color: #e0e0e0;
            font-family: 'Rajdhani', sans-serif;
            touch-action: manipulation;
            height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .font-orbitron { font-family: 'Orbitron', sans-serif; }

        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .neon-text-cyan {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        .neon-border-cyan {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }

        .active-row {
            border-left: 4px solid var(--neon-cyan);
            background: rgba(0, 243, 255, 0.05);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        .timer-running { animation: pulse 2s infinite ease-in-out; }
    </style>
</head>
<body class="p-4">

    <div class="relative w-full max-w-lg h-[90vh] glass-panel rounded-[32px] overflow-hidden flex flex-col">
        
        <header class="p-6 text-center border-b border-white/10">
            <h1 class="font-orbitron text-xl neon-text-cyan tracking-[0.3em]">AETHER.IO</h1>
        </header>

        <div class="flex-1 flex flex-col items-center justify-center p-6 space-y-4">
            <div id="status-label" class="text-white/40 tracking-widest uppercase text-sm">READY</div>
            <div id="timer-display" class="font-orbitron text-7xl sm:text-8xl font-bold text-white tracking-tighter">00:00</div>
            <div id="next-label" class="text-xs text-white/20 uppercase italic">Next: Set timers below</div>
        </div>

        <div id="timer-list" class="flex-1 overflow-y-auto px-6 space-y-3 custom-scroll pb-4">
            </div>

        <div class="p-6 bg-black/20 border-t border-white/10 space-y-4">
            <div class="flex gap-3">
                <button onclick="addTimerRow()" class="flex-1 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-xs font-bold transition">
                    <i class="fas fa-plus mr-2"></i>ADD STAGE
                </button>
                <button onclick="resetAll()" class="px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-xs font-bold transition">
                    RESET
                </button>
            </div>
            
            <button id="mainBtn" onclick="toggleMain()" class="w-full py-4 bg-[#00f3ff] text-black font-orbitron font-bold rounded-2xl shadow-[0_0_20px_rgba(0,243,255,0.3)] active:scale-95 transition">
                START CIRCUIT
            </button>
        </div>
    </div>

    <script>
        let timers = [
            { name: "Sprints", seconds: 30 },
            { name: "Recovery", seconds: 15 }
        ];
        
        let currentIndex = 0;
        let timeLeft = 0;
        let timerInterval = null;
        let audioCtx = null;

        function render() {
            const list = document.getElementById('timer-list');
            list.innerHTML = '';
            
            timers.forEach((t, index) => {
                const isActive = index === currentIndex && timerInterval;
                const row = document.createElement('div');
                row.className = `flex items-center gap-3 p-3 rounded-xl border border-white/5 bg-white/5 transition-all ${isActive ? 'active-row' : ''}`;
                
                row.innerHTML = `
                    <input class="bg-transparent text-sm font-bold text-white outline-none flex-1" 
                           value="${t.name}" onchange="updateTimer(${index}, 'name', this.value)">
                    <div class="flex items-center bg-black/30 rounded-lg px-2 border border-white/10">
                        <input class="bg-transparent w-10 py-1 text-center text-cyan-400 font-bold outline-none" 
                               type="number" value="${t.seconds}" onchange="updateTimer(${index}, 'seconds', this.value)">
                        <span class="text-[10px] text-white/30 pr-1">S</span>
                    </div>
                    <button onclick="removeTimer(${index})" class="text-white/20 hover:text-red-500 transition px-2">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                list.appendChild(row);
            });

            if (timers[currentIndex]) {
                const next = timers[currentIndex + 1];
                document.getElementById('next-label').textContent = next ? `Next Up: ${next.name}` : "Final Stage";
            }
        }

        function updateTimer(index, field, value) {
            timers[index][field] = field === 'seconds' ? Math.max(0, parseInt(value) || 0) : value;
            if (!timerInterval) syncDisplay();
        }

        function addTimerRow() {
            timers.push({ name: `Stage ${timers.length + 1}`, seconds: 30 });
            render();
        }

        function removeTimer(index) {
            timers.splice(index, 1);
            if (currentIndex >= timers.length) currentIndex = Math.max(0, timers.length - 1);
            render();
            syncDisplay();
        }

        function syncDisplay() {
            if (timers[currentIndex]) {
                timeLeft = timers[currentIndex].seconds;
                updateBigDisplay();
                document.getElementById('status-label').textContent = timers[currentIndex].name;
            }
        }

        function updateBigDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer-display').textContent = 
                `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function beep(freq = 880) {
            try {
                if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                if (audioCtx.state === 'suspended') audioCtx.resume();
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0.5, audioCtx.currentTime + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.4);
            } catch(e) {}
        }

        function toggleMain() {
            if (timerInterval) pause(); else start();
        }

        function start() {
            if (timers.length === 0) return;
            if (timeLeft <= 0) syncDisplay();
            
            document.getElementById('mainBtn').textContent = "PAUSE";
            document.getElementById('mainBtn').style.background = "#ff00ff"; // Magenta for pause
            document.getElementById('mainBtn').style.boxShadow = "0 0 20px rgba(255, 0, 255, 0.3)";
            document.getElementById('timer-display').classList.add('timer-running');

            timerInterval = setInterval(() => {
                timeLeft--;
                updateBigDisplay();

                if (timeLeft <= 0) {
                    currentIndex++;
                    if (currentIndex < timers.length) {
                        beep(880);
                        syncDisplay();
                        render();
                    } else {
                        finish();
                    }
                }
            }, 1000);
            render();
        }

        function pause() {
            clearInterval(timerInterval);
            timerInterval = null;
            document.getElementById('mainBtn').textContent = "RESUME";
            document.getElementById('mainBtn').style.background = "var(--neon-cyan)";
            document.getElementById('mainBtn').style.boxShadow = "0 0 20px rgba(0, 243, 255, 0.3)";
            document.getElementById('timer-display').classList.remove('timer-running');
            render();
        }

        function finish() {
            clearInterval(timerInterval);
            timerInterval = null;
            beep(440);
            document.getElementById('mainBtn').textContent = "START CIRCUIT";
            document.getElementById('mainBtn').style.background = "var(--neon-cyan)";
            document.getElementById('status-label').textContent = "FINISHED";
            document.getElementById('timer-display').classList.remove('timer-running');
            currentIndex = 0;
            render();
        }

        function resetAll() {
            pause();
            currentIndex = 0;
            syncDisplay();
            document.getElementById('status-label').textContent = "READY";
            render();
        }

        // Initialize
        syncDisplay();
        render();
    </script>
</body>
</html>
